language: node_js
node_js: stable

before_install:
  - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version version-number
  - export PATH="$HOME/.yarn/bin:$PATH"
#cache:
#  yarn: true
#  directories:
#    - node_modules
install:
- yarn install

script:
- hexo clean  
- hexo g
after_script:
- cd ./public
- git init
- git config user.name "${U_NAME}"
- git config user.email "${U_EMAIL}"
- git add .
- git commit -m "Update"
- git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:${P_BRANCH}
branches:
  only:
  - gh-pages-source
#env: #环境变量在travis-ci的仓库设置里面配置了就不需要在这里配置了
  #global:
  #- GH_REF: github.com/kuleyu/hexolog.git
